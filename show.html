<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"/>
<title>GeoPhotoShow - Show Photoset</title>
<style type="text/css">

body { margin:0; overflow:hidden; color:black; font-family:Arial,sans-serif; }
img { border:0; }
*:focus { outline:none }

img.f_icon        { width:75px; height:75px; margin:2px; }
img.f_icon:hover  { margin:0; border:2px solid yellow; }
img.f_thumb       { margin:2px; }
img.f_thumb:hover { margin:0; border:2px solid yellow; }
img.exp           { width:23px; height:27px; background:transparent url(/images/icons.png) no-repeat scroll 0px 0px; }
img.col           { width:23px; height:27px; background:transparent url(/images/icons.png) no-repeat scroll 0px -27px; }
img.close         { width:15px; height:15px; background:transparent url(/images/icons.png) no-repeat scroll 0px -54px; cursor:pointer; }
img.close:hover   {                          background:transparent url(/images/icons.png) no-repeat scroll -15px -54px; cursor:pointer; }
img.pos           { width:15px; height:15px; background:transparent url(/images/icons.png) no-repeat scroll -23px 0px; }
img.refresh       { width:62px; height:62px; background:transparent url(/images/icons.png) no-repeat scroll -38px -0px; cursor:pointer; }
img.refresh:hover {                          background:transparent url(/images/icons.png) no-repeat scroll -38px -62px; cursor:pointer; }
img.dropdn        { width:15px; height:15px; background:transparent url(/images/icons.png) no-repeat scroll 0px -99px; }
img.dropdn:hover  {                          background:transparent url(/images/icons.png) no-repeat scroll -15px -99px; }

div.selable       { width:62px; height:20px; background:transparent url(/images/icons.png) no-repeat scroll -38px -187px; cursor:pointer; line-height:20px; color:lightblue; }
div.selable:hover {                          background:transparent url(/images/icons.png) no-repeat scroll -38px -207px; color:white; }
div.selected      { width:62px; height:20px; background:transparent url(/images/icons.png) no-repeat scroll -38px -187px; line-height:20px; font-weight:bold; }

.sdh   { position:absolute; left:0px; top:1.7em; height:5px; }
.sdv   { position:absolute; left:0px; top:1.7em; width:5px; }
.sdvr  { position:absolute; left:-6px; top:1.7em; width:5px; }
.sdh  div { width:100%; }
.sdv  div { height:100%; }
.sdvr div { height:100%; right:-1px; }
.sd div { background-color:black; overflow:hidden; position:absolute; z-index:2; }
.sd .o1 { opacity:0.1; filter:alpha(opacity=10); } .sd .o2 { opacity:0.08; filter:alpha(opacity=8); } .sd .o3 { opacity:0.06; filter:alpha(opacity=6); } .sd .o4 { opacity:0.04; filter:alpha(opacity=4); } .sd .o5 { opacity:0.02; filter:alpha(opacity=2); }
.sd .h1 { height:1px; } .sd .h2 { height:2px; }  .sd .h3 { height:3px; }  .sd .h4 { height:4px; }  .sd .h5 { height:5px; }
.sd .v1 { width:1px; }  .sd .v2 { width:2px; }   .sd .v3 { width:3px; }   .sd .v4 { width:4px; }   .sd .v5 { width:5px; }

.range { position:absolute; }
.vline { position:absolute; width:1px; background-color:red; }
.hline { position:absolute; height:1px; background-color:red; }

#loading { position:absolute; left:47%; top:0px; padding:3px 10px; background-color:#FFF1A8; font-size:84%; font-weight:bold; display:none; }
#saving  { position:absolute; left:47%; top:0px; padding:3px 10px; background-color:#FFF1A8; font-size:84%; font-weight:bold; display:none; }
#error  { position:absolute; left:47%; top:0px; padding:3px 10px; background-color:red; font-size:84%; font-weight:bold; display:none; }

#userbar { text-align:right; margin-right:10px; font-size:84%; }

#header { position:relative; width:100%; height:50px; }
 #logo { float:left; padding:6px 10px; }
 #logo a { text-decoration:none; }
 #title { font-size:28px; font-weight:bold; padding-left:10px; }

#content { position:relative; width:100%; overflow:hidden; }
#panel { position:absolute; width:150px; top:0; z-index:10; background-color:white; }

.bar { position:relative; height:1.7em; line-height:1.7em; }
.bar span { font-size:80%; margin-left:10px; }
.switch a.sel { color:black; font-weight:bold; text-decoration:none; cursor:auto; }
#mainbar span { padding-right:2em; }
#mainbar span a { margin-right:1em; }

#tabs { position:relative; font-size:80%; background-color:white; }
.tab { position:absolute; top:6px; left:6px; bottom:6px; right:6px; overflow:hidden; display:none; }
.tab .tabrow { height: 2em; line-height: 2em; }

.pager_prev,
.pager_next { margin-right:3px; padding:3px 3px; color:#808185; cursor:pointer; }
.pager_dots { margin-right:3px;                  color:#808185; }
.pager_num,
.perpage_num,
.viewas_type,
.sortby_type { margin-right:3px; padding:2px 4px; color:#808185; border:1px solid #CCCCCC; cursor:pointer; }
.pager_num:hover,
.perpage_num:hover,
.viewas_type:hover,
.sortby_type:hover { background-color:lightblue; }
.pager_curr,
.perpage_curr,
.viewas_curr,
.sortby_curr { margin-right:3px; padding:2px 4px; color:white;   border:1px solid #808185; background-color:#808185; font-weight:bold; }


.photolist { position:absolute; left:0; right:0; bottom:0; overflow-x:hidden; overflow-y:auto; }
.photolist div.panel { width:110px; }

.photolist div.item_icon { position:relative; width:79px; height:79px; float:left; }
.photolist div.item_icon input { position:absolute; left:0px; top:57px; z-index:1; }
.photolist div.item_icon div.havpos { position:absolute; left:59px; top:59px; z-index:1; }

.photolist div.item_thumb { position:relative; width:104px; float:left; }
.photolist div.item_thumb:hover { background-color:lightyellow; }
.photolist div.item_thumb input { position:absolute; left:0px; top:0px; z-index:1; }
.photolist div.item_thumb div.havpos { position:absolute; left:3px; top:1.5em; z-index:1; }

.photolist div.item_detail { position:relative; }
.photolist div.item_detail:hover { background-color:lightyellow; }
.photolist div.item_detail input { float:left; }
.photolist div.item_detail div.havpos { position:absolute; top:2em; left:3px; }

.photolist div.item_detail a { text-decoration:none; }
.photolist div.item_detail a:hover { text-decoration:underline; }
.photolist div.item_detail div.thumb { position:relative; width:104px; float:left; text-align:center; }
.photolist div.item_detail div.desc { position:relative; width:280px; font-size:11px; float:left; padding:5px; }
.photolist div.item_detail div.desc span.title { font-size:14pt; font-weight:bold; }
.photolist div.item_detail div.desc img.buddy { float:left; width:25px; height:25px; margin:3px 8px; }

#showpanel h1 { margin:0; font-size:12pt; float:left; }
#showpanel a.title { color:#1057AE; }
#showpanel a.title:hover { color:white; text-decoration:none; background-color:#0063DC; }
#showpanel #showpanel_switch a { text-decoration:none; }
#showpanel #showpanel_switch a.sel { color:black; font-weight:bold; text-decoration:none; cursor:auto; }
#showpanel img.buddy { float:left; margin:3px 8px; }
</style>
</head>

<body onunload="GUnload()">

<div id="loading"> Loading... </div>
<div id="saving"></div>
<div id="error"></div>

<div id="content">
  <div id="settitle_control" style="text-align:center; font-size:11pt; padding:2px; background-color:white; border:1px solid black; display:none;"></div>
  <div id="mainbar" class="bar">
    <img id="show_title_dropdn_toggle" class="dropdn" src="/images/transparent.png" style="vertical-align:middle; margin-left:.5em;"/><span id="settitle"></span>
    <div id="show_title_dropdn" style="position:absolute; top:1.7em; z-index:1; margin-left:.5em; padding:.5em; border-left:1px solid gray;border-right:1px solid gray;border-bottom:1px solid gray; background-color:white; display:none;"></div>
  </div>
  <div id="map"></div>
  <div class="sd sdh"><div class="h1 o1"></div><div class="h2 o2"></div><div class="h3 o3"></div><div class="h4 o4"></div><div class="h5 o5"></div></div>
  <div class="sd sdv"><div class="v1 o1"></div><div class="v2 o2"></div><div class="v3 o3"></div><div class="v4 o4"></div><div class="v5 o5"></div></div>
  <div id="panel">
    <a id="panel_toggle" href="javascript:void(0)" style="position:absolute;"><img class="col" style="position:absolute; right:-1px;" src="/images/transparent.png"/></a>
    <div class="sd sdvr"><div class="v1 o1"></div><div class="v2 o2"></div><div class="v3 o3"></div><div class="v4 o4"></div><div class="v5 o5"></div></div>
    <div id="tabs">
    </div>
  </div>
</div>

<script type="text/javascript">
var gmap = null, user = null, API_KEY = '{{ API_KEY }}', mod_ctl = null, ui_ctl = null;
var settings_ctl = null;
var panelexp = false;

var params = '{{ params }}';
var photoid = '{{ photoid }}';
var fsetids = '{{ fsetids }}';
var gpxids = '{{ gpxids }}';

ui_ctl = {
	onResize: function(nopanel) {
		var h = $(window).height();
		var w = $(window).width();
		var $m = $('#map');
		var $p = $('#panel');

		var mw = panelexp ? w-$p.width() : w;
		var mh = h-$m.offset().top;
		var ph = h-$p.offset().top;

		$m.css({height:mh, width:mw});
		$('#mainbar').width(mw);
		$('#tabs').height(ph);
		$('.sdh').width(mw);
		$('.sdv').height(mh);
		$('.sdvr').height(mh);
		if(nopanel) {
			$p.css({height:ph});
		} else {
			var pr = panelexp ? 0 : -$p.width();
			$p.css({height:ph, right:pr});
		}

		$('#panel_toggle').children('img').attr('class', (panelexp?'col':'exp'));

		if(gmap) gmap.checkResize();
	},

	beginLoading: function() {
		$('#loading').show();
	},
	endLoading: function() {
		$('#loading').hide();
	},

	showSaving: function(str) {},
	hideSaving: function() {},

	expendPanel: function() {
		panelexp = true;
		$('#panel').animate({right:0}, 'fast', ui_ctl.onResize);
	},
	closePanel: function() {
		panelexp = false;
		ui_ctl.onResize(true);
		$p = $('#panel');
		$p.animate({right:-$p.width()}, 'fast');
	},

	savePosition: function() {
	},

	on_message: function(str) {},
	on_error: function(str) {
		$('#error').text(str).show();
	}
};
</script>

<script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2.x&amp;key=ABQIAAAA5iyLqLpUbk1qBe2volmsqxSGaeOUwwPiRwprcQIp1asxXaPRShRiXXnXJ0iaG0Cp007xopXguZyRPQ"></script>
<script type="text/javascript">


var jq_loaded = false, jq_notrun = true, mp_loaded = false, mp_notrun = true, an_loaded = false, an_notrun = true;
function init() {

if (jq_loaded && jq_notrun) {
	jq_notrun = false;

	ui_ctl.onResize();
	$(window).resize(ui_ctl.onResize);

	$('#panel_toggle').click(function() {
		panelexp = !panelexp;
		if(panelexp) {
			ui_ctl.expendPanel();
		} else {
			ui_ctl.closePanel();
		}
	});
}

if (jq_loaded && mp_loaded && mp_notrun) {
	mp_notrun = false;

	gmap = new GMap2(document.getElementById('map'));
	gmap.setUIToDefault();
	gmap.disableDoubleClickZoom();

	mod_ctl.init(['show']);
	mod_ctl.init_show('showpanel');

	if (fsetids) {
		var flickr_photoset_ids = [];

		while ( /^(\d+),?(.*)$/.exec(fsetids)) {
			var id = RegExp.$1;
			fsetids = RegExp.$2;
			flickr_photoset_ids.push(id);
		}
		var show_ctl = mod_ctl.switchTo('show');
		for (var i=0,n=flickr_photoset_ids.length; i<n; ++i) {
			show_ctl.loadPhotoSet(flickr_photoset_ids[i]);
		}
	} else if (photoid) {
		var flickr_photo_ids = [];
		while ( /^(\d+),?(.*)$/.exec(photoid)) {
			var id = RegExp.$1;
			photoid = RegExp.$2;
			flickr_photo_ids.push(id);
		}
		var show_ctl = mod_ctl.switchTo('show');
		show_ctl.loadPhoto(flickr_photo_ids);
	}
}

if (jq_loaded && mp_loaded && an_loaded && an_notrun) {
	an_notrun = false;

	if( typeof _gat !== 'undefined')
		_gat._getTracker("UA-359113-8")._trackPageview();
}

}

function loadjs(path, cb) {
	var jo = document.createElement('script');
	jo.done = false;
	jo.onload = function() { jo.done = true; cb(); };
	jo.onreadystatechange = function() { if (('complete' === jo.readyState || 'loaded' === jo.readyState) && !jo.done) { jo.done = true; cb(); } };
	jo.src = path;
	document.getElementsByTagName('head')[0].appendChild(jo);
}

loadjs('http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js', function() {
	jq_loaded = true;
	init();
});
loadjs("/scripts/flickr-maps.js", function() {
	mp_loaded = true;
	init();
});
loadjs('http://www.google-analytics.com/ga.js', function() {
	an_loaded = true;
	init();
});

// preload
var image1 = new Image();
image1.src = '/images/loading.gif';

</script>
</body>
</html>

